{% extends 'store/base.html' %}
{% load static %}
{% load crispy_forms_tags %}

{% block content %}
<style>
  body {
    background-color: gray;
  }
</style>

<body>
  <br>
  <!-- é é¦–æ¨™é¡Œ -->
  <div class="container bg-white shadow-md p-5 form-layout">
    <div style="display: flex; align-items: center; justify-content: center; position: relative;">
      <a href="{% url 'dashboard' %}" style="position: absolute; left: 0; color: #717070c8;">
        <i class="fa fa-undo fa-2x"></i>
      </a>
      <h3 style="margin: 0;">My Orders</h3>
    </div>
    <hr>
  </div>

  <br>

  <!-- è¨‚å–®æ¸…å–® -->
  <div class="container bg-white shadow-md p-5 form-layout">

    {% if page_obj %}
      {% for entry in page_obj %}
        <hr>
        <h5><i class="fa fa-bookmark" aria-hidden="true"></i>&nbsp;Order #{{ entry.order.id }}</h5>
        <strong>&nbsp;Date: {{ entry.order.date_ordered }}</strong>
        <span style="margin-left: 20px;">
          {% if entry.order.payment_status == "COMPLETED" %}
            <span class="badge bg-success">å·²ä»˜æ¬¾</span>
          {% elif entry.order.payment_status == "PENDING" %}
            <span class="badge bg-warning text-dark">å¾…ç¢ºèª</span>
          {% elif entry.order.payment_status == "REFUNDING" %}
            <span class="badge bg-danger">é€€æ¬¾è™•ç†ä¸­</span>
          {% elif entry.order.payment_status == "REFUNDED" %}
            <span class="badge bg-danger">å·²é€€æ¬¾</span>
          {% else %}
            <span class="badge bg-danger">æœªä»˜æ¬¾</span>
          {% endif %}
        </span>
        <br>

        <!-- æ”¶ä»¶è³‡è¨Š -->
        <strong>&nbsp;Shipping Address:
          {{ entry.order.shipping_address }}
        </strong>
          <!-- ğŸšš æ–°å¢ç‰©æµè³‡è¨Š -->
        <div style="margin-top: 10px; margin-left: 25px;">
          <p class="mb-1"><strong>ç‰©æµå…¬å¸ï¼š</strong>
            {{ entry.order.shipping_carrier }}
          </p>

          <p class="mb-1"><strong>è¿½è¹¤ç·¨è™Ÿï¼š</strong>
            {% if entry.order.tracking_number %}
              {{ entry.order.tracking_number }}
            {% else %}
              â€”
            {% endif %}
          </p>

          <p class="mb-1">
            <strong>ç‰©æµç‹€æ…‹ï¼š</strong>
            {% if entry.order.shipping_status %}
              {{ entry.order.shipping_status }}
            {% else %}
              â€”
            {% endif %}
          </p>

          <p class="mb-1">
            <strong>æœ€å¾Œæ›´æ–°ï¼š</strong>
            {% if entry.order.tracking_updated_at %}
              {{ entry.order.tracking_updated_at|date:"Y-m-d H:i" }}
            {% else %}
              â€”
            {% endif %}
          </p>
        </div>

        <hr>

        <!-- å•†å“é …ç›® -->
        {% for item in entry.items %}
          <div style="display: flex; align-items: center; margin-bottom: 15px;">
            <!-- å•†å“åœ–ç‰‡ -->
            {% if item.product.thumbnail %}
              <img src="{{ item.product.thumbnail.url }}" alt="{{ item.product.title }}"
                   style="width: 130px; height: 130px; object-fit: cover; border-radius: 8px; margin-right: 15px;">
            {% else %}
              <img src="{% static 'images/no-image.png' %}" alt="No image"
                   style="width: 130px; height: 130px; object-fit: cover; border-radius: 8px; margin-right: 15px;">
            {% endif %}

            <!-- å•†å“è³‡è¨Š -->
            <div>
              <strong>{{ item.product.title }}</strong><br>
              ${{ item.price }} Ã— {{ item.quantity }}
            </div>
          </div>
        {% endfor %}

        <!-- å°è¨ˆã€é‹è²»ã€ç¸½é¡ -->
        <div style="text-align: right; margin-top: 10px;">
          <p class="mb-1"><strong>Subtotal:</strong> ${{ entry.order.subtotal }}</p>
          <p class="mb-1"><strong>Shipping:</strong> ${{ entry.order.shipping_fee }}</p>
          <p class="h5 fw-bold text-danger">Total: ${{ entry.order.amount_paid }}</p>
        </div>

        <br>
      {% endfor %}

      <!-- åˆ†é  -->
      <nav aria-label="Page navigation">
        <ul class="pagination justify-content-center">
          {% if page_obj.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.previous_page_number }}">ä¸Šä¸€é </a>
            </li>
          {% endif %}

          {% for num in page_obj.paginator.page_range %}
            {% if page_obj.number == num %}
              <li class="page-item active">
                <span class="page-link">{{ num }}</span>
              </li>
            {% else %}
              <li class="page-item">
                <a class="page-link" href="?page={{ num }}">{{ num }}</a>
              </li>
            {% endif %}
          {% endfor %}

          {% if page_obj.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ page_obj.next_page_number }}">ä¸‹ä¸€é </a>
            </li>
          {% endif %}
        </ul>
      </nav>

    {% else %}
      <p>No orders found.</p>
    {% endif %}
  </div>
</body>
{% endblock content %}
